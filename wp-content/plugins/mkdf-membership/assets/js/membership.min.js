if(function(e,a,s){var r,i=e.getElementsByTagName(a)[0];e.getElementById(s)||((r=e.createElement(a)).id=s,r.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(r,i))}(document,"script","facebook-jssdk"),"undefined"!=typeof mkdfSocialLoginVars)var facebookAppId=mkdfSocialLoginVars.social.facebookAppId;facebookAppId&&(window.fbAsyncInit=function(){FB.init({appId:facebookAppId,cookie:!0,xfbml:!0,version:"v5.0"}),window.FB=FB}),function(e){"use strict";var a={};function s(){var a=e(".mkdf-login-opener"),s=e(".mkdf-login-register-holder");if(e(document.body).on("open_user_login_trigger",function(){s.fadeIn(300),s.addClass("opened")}),a){var r=e(".mkdf-login-register-content");a.click(function(e){e.preventDefault(),s.fadeIn(300),s.addClass("opened")}),s.click(function(e){s.hasClass("opened")&&(s.fadeOut(300),s.removeClass("opened"))}),r.click(function(e){e.stopPropagation()}),e(window).on("keyup",function(e){s.hasClass("opened")&&27==e.keyCode&&(s.fadeOut(300),s.removeClass("opened"))}),r.tabs()}}function r(){e(".mkdf-login-form").on("submit",function(a){a.preventDefault();var s={action:"mkdf_membership_login_user",security:e(this).find("#mkdf-login-security").val(),login_data:e(this).serialize()};return e.ajax({type:"POST",data:s,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){var a;o(a=JSON.parse(e)),"success"==a.status&&(window.location=a.redirect)}}),!1})}function i(){e(".mkdf-register-form").on("submit",function(a){a.preventDefault();var s={action:"mkdf_membership_register_user",security:e(this).find("#mkdf-register-security").val(),register_data:e(this).serialize()};return e.ajax({type:"POST",data:s,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){var a;o(a=JSON.parse(e)),"success"==a.status&&(window.location=a.redirect)}}),!1})}function t(){var a=e(".mkdf-reset-pass-form");a.submit(function(s){s.preventDefault();var r={action:"mkdf_membership_user_lost_password",user_login:a.find("#user_reset_password_login").val()};e.ajax({type:"POST",data:r,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){var a=JSON.parse(e);o(a),"success"==a.status&&(window.location=a.redirect)}})})}function o(a){var s=e(".mkdf-membership-response-holder"),r=_.template(e(".mkdf-membership-response-template").html())({messageClass:"success"===a.status?"mkdf-membership-message-succes":"mkdf-membership-message-error",message:a.message});s.html(r)}function n(){e(".mkdf-facebook-login-holder").submit(function(a){a.preventDefault(),window.FB.login(function(a){!function(a){"connected"===a.status?(console.log("Welcome! Fetching information from Facebook..."),FB.api("/me","GET",{fields:"id, name, email, link, picture"},function(a){var s=e(".mkdf-facebook-login-holder [name^=mkdf_nonce_facebook_login]").val();a.nonce=s,a.image=a.picture.data.url;var r={action:"mkdf_membership_check_facebook_user",response:a};e.ajax({type:"POST",data:r,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){var a;o(a=JSON.parse(e)),"success"==a.status&&(window.location=a.redirect)}})})):"not_authorized"===a.status?console.log("Please log into this app"):console.log("Please log into Facebook")}(a)},{scope:"email, public_profile"})})}function d(){if("undefined"!=typeof mkdfSocialLoginVars)var a=mkdfSocialLoginVars.social.googleClientId;a?gapi.load("auth2",function(){window.auth2=gapi.auth2.init({client_id:a}),e(".mkdf-google-login-holder").submit(function(a){a.preventDefault(),window.auth2.signIn(),function(){if(window.auth2.isSignedIn.get()){var a=window.auth2.currentUser.get(),s=a.getBasicProfile(),r=e(".mkdf-google-login-holder [name^=mkdf_nonce_google_login]").val(),i={id:s.getId(),name:s.getName(),email:s.getEmail(),image:s.getImageUrl(),link:"https://plus.google.com/"+s.getId(),nonce:r},t={action:"mkdf_membership_check_google_user",response:i};e.ajax({type:"POST",data:t,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){var a;o(a=JSON.parse(e)),"success"==a.status&&(window.location=a.redirect)}})}}()})}):e(".mkdf-google-login-holder").submit(function(e){e.preventDefault()})}function l(){var a=e("#mkdf-membership-update-profile-form");if(a.length){var s=a.find("button"),r=s.data("updating-text"),i=s.data("updated-text");a.on("submit",function(a){a.preventDefault();var t=s.html();s.html(r);var n={action:"mkdf_membership_update_user_profile",data:e(this).serialize()};return e.ajax({type:"POST",data:n,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){var a;o(a=JSON.parse(e)),"success"==a.status?(s.html(i),window.location=a.redirect):s.html(t)}}),!1})}}function m(){var a=e(".mkdf-membership-gallery-uploader");a.length&&a.each(function(){var a=e(this),s=a.find(".mkdf-membership-gallery-upload-hidden"),r=a.find(".mkdf-membership-gallery-upload"),i=a.parents(".mkdf-membership-gallery-holder").find(".mkdf-membership-gallery-images-holder");r.hasClass("mkdf-binded")||(s.on("change",function(a){a.target.files.length;i.empty();for(var s,r=0;s=a.target.files[r];r++){var t=new FileReader;t.onload=function(a){return function(s){"-1"!=e.inArray(a.type,["image/gif","image/jpeg","image/png"])?i.append('<li class="mkdf-membership-gallery-image"><img src="'+s.target.result+'" title="'+escape(a.name)+'"/></li>'):i.append('<li class="mkdf-membership-gallery-image"><span class="mkdf-membership-input-text">'+escape(a.name)+"</span></li>")}}(s),t.readAsDataURL(s)}}),r.on("click",function(e){e.preventDefault(),s.trigger("click")}),r.addClass("mkdf-binded"))})}function f(){var a=e(".mkdf-membership-remove-image");a.length&&a.each(function(){var a=e(this),s=a.parents(".mkdf-membership-gallery-holder").find(".mkdf-membership-gallery-images-holder"),r=a.siblings(".mkdf-membership-media-hidden");a.hasClass("mkdf-binded")||(a.on("click",function(e){e.preventDefault(),r.val(""),s.empty()}),a.addClass("mkdf-binded"))})}"undefined"!=typeof mkdf&&(mkdf.modules.socialLogin=a),a.mkdfUserLogin=r,a.mkdfUserRegister=i,a.mkdfUserLostPassword=t,a.mkdfInitLoginWidgetModal=s,a.mkdfInitFacebookLogin=n,a.mkdfInitGooglePlusLogin=d,a.mkdfUpdateUserProfile=l,a.mkdfRenderAjaxResponseMessage=o,e(document).ready(function(){s(),r(),i(),t(),l(),e(".mkdf-membership-input.datepicker").datepicker({dateFormat:"MM dd, yy"}),m(),function(){var a=e(".mkdf-membership-repeater-wrapper");a.length&&a.each(function(){var a=e(this);s(a)});function s(a){r(a),function(a){var s,r=a.find("> .mkdf-membership-repeater-fields-holder");s=r.hasClass("mkdf-table-layout")?r.find("tbody tr.mkdf-membership-repeater-fields-row"):r.find("> .mkdf-membership-repeater-fields-row");s.each(function(){var a=e(this);a.hasClass("mkdf-initially-hidden")&&a.hide()})}(a);var i=a.find("> .mkdf-membership-repeater-add .mkdf-clone");i.on("click",function(i){i.preventDefault();var t=e(this);!function(a,i){var t,o=a.find("> .mkdf-membership-repeater-fields-holder"),n=!!o.hasClass("mkdf-enable-pc");if(o.hasClass("mkdf-table-layout"))t=o.find("tbody tr.mkdf-membership-repeater-fields-row");else if(n){var d=i.data("name");t=o.find("> .mkdf-membership-repeater-fields-row[data-name="+d+"]")}else t=o.find("> .mkdf-membership-repeater-fields-row");var l=!0;1==t.length&&"none"==t.css("display")&&(t.show(),l=!1);if(l){var c=t.eq(0);c.find(".mkdf-membership-repeater-field").each(function(){var a=e(this);a.find("select").each(function(){var a=e(this);a.hasClass("mkdf-select2")&&e("select.mkdf-select2").select2("destroy")})});var p=i.data("count"),h=t.eq(0).clone(),u=!1,g=!1,k=!1;h.find(".mkdf-membership-repeater-field").each(function(){var a=e(this),s=a.attr("id");void 0!==s&&a.attr("id",s.slice(0,-1)+p),a.find(":input, textarea").each(function(){var a=e(this);if(a.hasClass("mkdf-membership-gallery-upload-hidden")){u=!0;var s=a.siblings(".mkdf-membership-gallery-upload");!function(a){var s=a.parents(".mkdf-membership-gallery-holder").find(".mkdf-membership-gallery-images-holder"),r=a.siblings(".mkdf-membership-remove-image");a.removeClass("mkdf-binded"),r.removeClass("mkdf-binded"),s.empty(),a.siblings(".mkdf-membership-gallery-upload-hidden").each(function(a){e(this).val("")})}(s)}else a.hasClass("checkbox")&&(g=!0);a.val("").removeAttr("checked").removeAttr("selected"),a.is(":radio")&&a.val(o.find(":radio").length)}),a.find("select").each(function(){var a=e(this);a.hasClass("mkdf-select2")&&(k=!0)})}),t.each(function(){e(this).find(".mkdf-membership-repeater-wrapper").length&&!0}),i.data("count",p+1),h.appendTo(o),s(h.find(".mkdf-membership-repeater-wrapper")),r(h),u&&(e(".mkdf-media-uploader").off("click",".mkdf-media-upload-btn"),m(),f()),g&&mkdfInitSwitch(),k&&mkdfSelect2()}}(a,t)})}function r(a){var s=a.find(".mkdf-clone-remove");s.on("click",function(a){a.preventDefault();var s,r=e(this),i=r.closest(".mkdf-membership-repeater-fields-row"),t=r.closest(".mkdf-membership-repeater-fields-holder"),o=!!t.hasClass("mkdf-enable-pc");if(t.hasClass("mkdf-table-layout"))s=t.find("tbody tr.mkdf-membership-repeater-fields-row");else if(o){var n=r.data("name");s=t.find("> .mkdf-membership-repeater-fields-row[data-name="+n+"]")}else s=t.find("> .mkdf-membership-repeater-fields-row");1==s.length?(i.find(":input").val("").removeAttr("checked").removeAttr("selected"),i.hide()):i.remove()})}}(),o=e(".mkdf-membership-sortable-holder"),n=o.hasClass("mkdf-enable-pc"),o.sortable({handle:".mkdf-membership-repeater-sort",cursor:"move",placeholder:"placeholder",start:function(e,a){a.placeholder.height(a.item.height()),n&&(a.helper.hasClass("second-level")?(a.placeholder.removeClass("placeholder"),a.placeholder.addClass("placeholder-sub")):(a.placeholder.removeClass("placeholder-sub"),a.placeholder.addClass("placeholder")))},sort:function(e,a){var s;n&&((s=a.helper.hasClass("second-level")?a.position.left+50:a.position.left)>=75&&!a.helper.hasClass("second-level")&&!a.helper.hasClass("mkdf-sort-parent")?(a.placeholder.removeClass("placeholder"),a.placeholder.addClass("placeholder-sub"),a.helper.addClass("second-level")):s<30&&a.helper.hasClass("second-level")&&!a.helper.hasClass("mkdf-sort-child")&&(a.placeholder.removeClass("placeholder-sub"),a.placeholder.addClass("placeholder"),a.helper.removeClass("second-level")))}}),a=e(".mkdf-membership-address-field"),a.length&&a.each(function(){var a=e(this),s=a.find("#reset"),r=a.find("input"),i=a.find(".map_canvas"),t=a.data("country"),o=a.data("lat-field"),n=e("input[name="+o+"]"),d=a.data("long-field"),l=e("input[name="+d+"]"),m=r.val(),f=n.val(),c=l.val();r.geocomplete({map:i,details:".mkdf-membership-address-elements",detailsAttribute:"data-geo",types:["geocode","establishment"],country:t,markerOptions:{draggable:!0}}),r.bind("geocode:dragged",function(a,s){n.val(s.lat()),l.val(s.lng()),e("#reset").show(),console.log(s);var i=r.geocomplete("map");i.panTo(s);var t=new google.maps.Geocoder;t.geocode({latLng:s},function(e,a){if(a==google.maps.GeocoderStatus.OK&&e[0]){var s=e[0].address_components[1].short_name,i=e[0].address_components[2].short_name,t=e[0].address_components[3].short_name,o=e[0].address_components[4].short_name;r.val(s+" "+i+" "+t+" "+o)}})}),r.on("focus",function(){var e=r.geocomplete("map");google.maps.event.trigger(e,"resize")}),s.on("click",function(){return r.geocomplete("resetMarker"),r.val(m),n.val(f),l.val(c),e("#reset").hide(),!1}),e(window).on("load",function(){r.trigger("geocode")})}),f();var a;var o,n}),e(window).load(function(){n(),d(),function(){e(".mkdf-membership-main-wrapper");var a=e(".page-template-user-dashboard .mkdf-content"),s=e(".mkdf-page-footer"),r=0;!mkdf.body.hasClass("mkdf-header-transparent")&&mkdf.windowWidth>1024&&(r=r+mkdfGlobalVars.vars.mkdfMenuAreaHeight+mkdfGlobalVars.vars.mkdfLogoAreaHeight);s.length>0&&(r+=s.outerHeight());if(mkdf.windowWidth>1024){var i=mkdf.windowHeight-r;a.css({"min-height":i+"px"})}}()}),e(window).resize(function(){}),e(window).scroll(function(){})}(jQuery);